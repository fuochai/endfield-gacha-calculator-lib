终末地抽卡计算器  
================

本项目为《终末地》抽卡模拟工具，可计算在指定抽卡次数与保底规则下获得目标 UP 数量的概率分布。

功能一览  
--------

- 支持自定义当前已抽次数、水位、已出 UP 数  
- 可选关闭第 30 抽赠送十连、120 抽保底、每 240 抽赠送潜能等特殊规则  
- 结果存为 CSV
- 为讨厌浮点误差的用户提供有理数精确计算

使用说明  
----------

1. 前往 GitHub Releases 页面，根据系统下载对应可执行文件  
   https://github.com/fuochai/endfield-gacha-calculator-lib/releases/latest

2. 将文件放到有读写权限的目录，打开终端（或 PowerShell），执行：  
   Linux 需先赋可执行权限，例如 chmod +x ./文件名

3. 不带参数会显示帮助

4. 示例
   ```bash
      ./程序名 -c 当前已抽次数 -w 当前水位 -u 已抽到的 up 数 --total-up-count 总计要抽的 up 数 -t 总计要抽的次数
   ```

保底规则与实现
------------

1. 65 - 79 水位的六星概率递增：
   64 时为基础概率 `0.008` ，每次递增 `0.05` ，79 水位直接设为 `1`。
   默认开启，无法关闭。

2. 第 30 抽赠送不与其余机制交互的十连：
   与第 30 抽的结果一起计算。因此，第 30 抽中本次抽出首个 up 和抽出第二个 up 不为独立事件。
   默认开启，可关闭。

3. 第 60 抽赠送下期十连：
   没有考虑。因为该机制不影响本池的结果，就当之后合成玉增加了就行。

4. 第 120 保底：
   前 119 抽没有获得up时，第 120 抽的 up 概率修改为 `1`。
   默认开启，可关闭。

5. 每 240 抽赠送潜能：
   每 240 抽时额外进行一次必出 up 的不与其余机制交互的单抽。
   默认开启，可关闭。


常见问题  
--------


1. 没有提供期望值计算，因为这个数值的意义通常不大。
   （事实上你可以根据表格的数据进行计算。）
   我可以直接告诉你首个 up 的期望值在$\frac{34400428723673271540594131857871506361238288200430257410470222207465117803921680197854380326636504539299794048165122957110186169738477958825665064861903534901222417997420759665527590983502369592500433593180389665963547293130196722306012808273664763201271461692078924175864048720359831785913291747991532162664131} {431808427754722231269317593140019978555800018221814069251185173508429590158121352898575375173614411328027364697307483179849754947341597334682650188852903738734312355518341064453125000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000} \approx 79.66595025147022$
   但是在第 80 抽，仅有 `0.5737129448763467` 的概率可以获得至少一个 up。

2. 请勿直接用表格中不同位置的数据进行条件概率运算，因为这通常意义不大。
   因为表格中的概率代表的状态是不同水位的概率叠加态，但当你抽到那个状态时，你的水位是一个确定的值，这个时候请用新的水位重新计算。

3. 欢迎指出代码中的 bug，但作者仅接受与代码正确性相关的反馈，不会回应任何基于蒙特卡洛或其他方法的计算结果对比建议。


许可证  
------

本项目采用 MIT License

